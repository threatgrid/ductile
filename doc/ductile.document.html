<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>ductile.document documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Ductile</span> <span class="project-version">0.4.3-SNAPSHOT</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="intro.html"><div class="inner"><span>Ductile</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ductile</span></div></div></li><li class="depth-2"><a href="ductile.auth.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>auth</span></div></a></li><li class="depth-3"><a href="ductile.auth.api-key.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>api-key</span></div></a></li><li class="depth-2 branch"><a href="ductile.conn.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>conn</span></div></a></li><li class="depth-2 branch current"><a href="ductile.document.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>document</span></div></a></li><li class="depth-2 branch"><a href="ductile.index.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>index</span></div></a></li><li class="depth-2 branch"><a href="ductile.pagination.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>pagination</span></div></a></li><li class="depth-2 branch"><a href="ductile.query.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>query</span></div></a></li><li class="depth-2"><a href="ductile.schemas.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>schemas</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="ductile.document.html#var-bulk"><div class="inner"><span>bulk</span></div></a></li><li class="depth-1"><a href="ductile.document.html#var-bulk-create-docs"><div class="inner"><span>bulk-create-docs</span></div></a></li><li class="depth-1"><a href="ductile.document.html#var-bulk-delete-docs"><div class="inner"><span>bulk-delete-docs</span></div></a></li><li class="depth-1"><a href="ductile.document.html#var-bulk-index-docs"><div class="inner"><span>bulk-index-docs</span></div></a></li><li class="depth-1"><a href="ductile.document.html#var-bulk-update-docs"><div class="inner"><span>bulk-update-docs</span></div></a></li><li class="depth-1"><a href="ductile.document.html#var-bulk-uri"><div class="inner"><span>bulk-uri</span></div></a></li><li class="depth-1"><a href="ductile.document.html#var-BulkActions"><div class="inner"><span>BulkActions</span></div></a></li><li class="depth-1"><a href="ductile.document.html#var-BulkOps"><div class="inner"><span>BulkOps</span></div></a></li><li class="depth-1"><a href="ductile.document.html#var-byte-size"><div class="inner"><span>byte-size</span></div></a></li><li class="depth-1"><a href="ductile.document.html#var-count-docs"><div class="inner"><span>count-docs</span></div></a></li><li class="depth-1"><a href="ductile.document.html#var-count-uri"><div class="inner"><span>count-uri</span></div></a></li><li class="depth-1"><a href="ductile.document.html#var-create-doc"><div class="inner"><span>create-doc</span></div></a></li><li class="depth-1"><a href="ductile.document.html#var-default-limit"><div class="inner"><span>default-limit</span></div></a></li><li class="depth-1"><a href="ductile.document.html#var-default-retry-on-conflict"><div class="inner"><span>default-retry-on-conflict</span></div></a></li><li class="depth-1"><a href="ductile.document.html#var-delete-by-query"><div class="inner"><span>delete-by-query</span></div></a></li><li class="depth-1"><a href="ductile.document.html#var-delete-by-query-uri"><div class="inner"><span>delete-by-query-uri</span></div></a></li><li class="depth-1"><a href="ductile.document.html#var-delete-doc"><div class="inner"><span>delete-doc</span></div></a></li><li class="depth-1"><a href="ductile.document.html#var-delete-doc-uri"><div class="inner"><span>delete-doc-uri</span></div></a></li><li class="depth-1"><a href="ductile.document.html#var-format-bulk-doc-fn"><div class="inner"><span>format-bulk-doc-fn</span></div></a></li><li class="depth-1"><a href="ductile.document.html#var-format-bulk-docs"><div class="inner"><span>format-bulk-docs</span></div></a></li><li class="depth-1"><a href="ductile.document.html#var-format-bulk-res"><div class="inner"><span>format-bulk-res</span></div></a></li><li class="depth-1"><a href="ductile.document.html#var-generate-search-params"><div class="inner"><span>generate-search-params</span></div></a></li><li class="depth-1"><a href="ductile.document.html#var-get-doc"><div class="inner"><span>get-doc</span></div></a></li><li class="depth-1"><a href="ductile.document.html#var-get-doc-uri"><div class="inner"><span>get-doc-uri</span></div></a></li><li class="depth-1"><a href="ductile.document.html#var-index-doc"><div class="inner"><span>index-doc</span></div></a></li><li class="depth-1"><a href="ductile.document.html#var-index-doc-uri"><div class="inner"><span>index-doc-uri</span></div></a></li><li class="depth-1"><a href="ductile.document.html#var-params-.3Epagination"><div class="inner"><span>params-&gt;pagination</span></div></a></li><li class="depth-1"><a href="ductile.document.html#var-partition-json-ops"><div class="inner"><span>partition-json-ops</span></div></a></li><li class="depth-1"><a href="ductile.document.html#var-query"><div class="inner"><span>query</span></div></a></li><li class="depth-1"><a href="ductile.document.html#var-search-docs"><div class="inner"><span>search-docs</span></div></a></li><li class="depth-1"><a href="ductile.document.html#var-search-uri"><div class="inner"><span>search-uri</span></div></a></li><li class="depth-1"><a href="ductile.document.html#var-sort-params"><div class="inner"><span>sort-params</span></div></a></li><li class="depth-1"><a href="ductile.document.html#var-string-.3Einput-stream"><div class="inner"><span>string-&gt;input-stream</span></div></a></li><li class="depth-1"><a href="ductile.document.html#var-update-by-query"><div class="inner"><span>update-by-query</span></div></a></li><li class="depth-1"><a href="ductile.document.html#var-update-by-query-uri"><div class="inner"><span>update-by-query-uri</span></div></a></li><li class="depth-1"><a href="ductile.document.html#var-update-doc"><div class="inner"><span>update-doc</span></div></a></li><li class="depth-1"><a href="ductile.document.html#var-update-doc-uri"><div class="inner"><span>update-doc-uri</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">ductile.document</h1><div class="doc"><pre class="plaintext"></pre></div><div class="public anchor" id="var-bulk"><h3>bulk</h3><div class="usage"><code>(bulk conn actions opts)</code><code>(bulk {:keys [version], :as conn} actions opts max-size)</code></div><div class="doc"><pre class="plaintext">Inputs: ([conn :- ESConn actions :- BulkActions opts :- CRUDOptions] [{:keys [version], :as conn} :- ESConn actions :- BulkActions opts :- CRUDOptions max-size :- (s/maybe s/Int)])

Bulk actions on ES</pre></div></div><div class="public anchor" id="var-bulk-create-docs"><h3>bulk-create-docs</h3><div class="usage"><code>(bulk-create-docs conn docs opts)</code><code>(bulk-create-docs conn docs opts max-size)</code></div><div class="doc"><pre class="plaintext">Inputs: ([conn :- ESConn docs :- [(s/pred map?)] opts :- CRUDOptions] [conn :- ESConn docs :- [(s/pred map?)] opts :- CRUDOptions max-size :- (s/maybe s/Int)])

create multiple documents on ES</pre></div></div><div class="public anchor" id="var-bulk-delete-docs"><h3>bulk-delete-docs</h3><div class="usage"><code>(bulk-delete-docs conn docs opts)</code><code>(bulk-delete-docs conn docs opts max-size)</code></div><div class="doc"><pre class="plaintext">Inputs: ([conn :- ESConn docs :- [(st/open-schema {:_id s/Str, :_index s/Str})] opts :- CRUDOptions] [conn :- ESConn docs :- [s/Any] opts :- CRUDOptions max-size :- (s/maybe s/Int)])

delete multiple documents on ES</pre></div></div><div class="public anchor" id="var-bulk-index-docs"><h3>bulk-index-docs</h3><div class="usage"><code>(bulk-index-docs conn docs opts)</code><code>(bulk-index-docs conn docs opts max-size)</code></div><div class="doc"><pre class="plaintext">Inputs: ([conn :- ESConn docs :- [(s/pred map?)] opts :- CRUDOptions] [conn :- ESConn docs :- [s/Any] opts :- CRUDOptions max-size :- (s/maybe s/Int)])

index multiple documents on ES</pre></div></div><div class="public anchor" id="var-bulk-update-docs"><h3>bulk-update-docs</h3><div class="usage"><code>(bulk-update-docs conn docs opts)</code><code>(bulk-update-docs conn docs opts max-size)</code></div><div class="doc"><pre class="plaintext">Inputs: ([conn :- ESConn docs :- [(st/open-schema {:_id s/Str, :_index s/Str})] opts :- CRUDOptions] [conn :- ESConn docs :- [s/Any] opts :- CRUDOptions max-size :- (s/maybe s/Int)])

update multiple documents on ES</pre></div></div><div class="public anchor" id="var-bulk-uri"><h3>bulk-uri</h3><div class="usage"><code>(bulk-uri uri)</code></div><div class="doc"><pre class="plaintext">make an uri for bulk action
</pre></div></div><div class="public anchor" id="var-BulkActions"><h3>BulkActions</h3><div class="usage"></div><div class="doc"><pre class="plaintext">
</pre></div></div><div class="public anchor" id="var-BulkOps"><h3>BulkOps</h3><div class="usage"></div><div class="doc"><pre class="plaintext">
</pre></div></div><div class="public anchor" id="var-byte-size"><h3>byte-size</h3><div class="usage"><code>(byte-size s)</code></div><div class="doc"><pre class="plaintext">Count the size of the given string in bytes.
</pre></div></div><div class="public anchor" id="var-count-docs"><h3>count-docs</h3><div class="usage"><code>(count-docs {:keys [uri request-fn], :as conn} index-name query)</code><code>(count-docs es-conn index-name)</code></div><div class="doc"><pre class="plaintext">Inputs: ([{:keys [uri request-fn], :as conn} :- ESConn index-name :- s/Str query :- (s/maybe ESQuery)] [es-conn :- ESConn index-name :- s/Str])

Count documents on ES matching given query.</pre></div></div><div class="public anchor" id="var-count-uri"><h3>count-uri</h3><div class="usage"><code>(count-uri uri index-name)</code></div><div class="doc"><pre class="plaintext">make an uri for search action
</pre></div></div><div class="public anchor" id="var-create-doc"><h3>create-doc</h3><div class="usage"><code>(create-doc conn index-name doc opts)</code><code>(create-doc conn index-name doc-type doc opts)</code></div><div class="doc"><pre class="plaintext">Inputs: ([conn :- ESConn index-name :- s/Str doc :- s/Any opts :- CRUDOptions] [conn :- ESConn index-name :- s/Str doc-type :- (s/maybe s/Str) doc :- s/Any opts :- CRUDOptions])

create a document on es return the created document</pre></div></div><div class="public anchor" id="var-default-limit"><h3>default-limit</h3><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-default-retry-on-conflict"><h3>default-retry-on-conflict</h3><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-delete-by-query"><h3>delete-by-query</h3><div class="usage"><code>(delete-by-query {:keys [uri request-fn], :as conn} index-names q opts)</code></div><div class="doc"><pre class="plaintext">Inputs: [{:keys [uri request-fn], :as conn} :- ESConn index-names :- [s/Str] q :- ESQuery opts :- CRUDOptions]

delete all documents that match a query in an index</pre></div></div><div class="public anchor" id="var-delete-by-query-uri"><h3>delete-by-query-uri</h3><div class="usage"><code>(delete-by-query-uri uri index-names)</code></div><div class="doc"><pre class="plaintext">Inputs: [uri index-names]
</pre></div></div><div class="public anchor" id="var-delete-doc"><h3>delete-doc</h3><div class="usage"><code>(delete-doc conn index-name id opts)</code><code>(delete-doc {:keys [uri request-fn version], :as conn} index-name doc-type id opts)</code></div><div class="doc"><pre class="plaintext">Inputs: ([conn :- ESConn index-name :- s/Str id :- s/Str opts :- CRUDOptions] [{:keys [uri request-fn version], :as conn} :- ESConn index-name :- s/Str doc-type :- (s/maybe s/Str) id :- s/Str opts :- CRUDOptions])

delete a document on es, returns boolean</pre></div></div><div class="public anchor" id="var-delete-doc-uri"><h3>delete-doc-uri</h3><div class="usage"></div><div class="doc"><pre class="plaintext">make an uri for doc deletion
</pre></div></div><div class="public anchor" id="var-format-bulk-doc-fn"><h3>format-bulk-doc-fn</h3><div class="usage"><code>(format-bulk-doc-fn op-type)</code></div><div class="doc"><pre class="plaintext">helper to prepare a bulk operation
</pre></div></div><div class="public anchor" id="var-format-bulk-docs"><h3>format-bulk-docs</h3><div class="usage"><code>(format-bulk-docs op-type documents)</code></div><div class="doc"><pre class="plaintext">generates the content for a bulk operation
</pre></div></div><div class="public anchor" id="var-format-bulk-res"><h3>format-bulk-res</h3><div class="usage"><code>(format-bulk-res bulk-res-list)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-generate-search-params"><h3>generate-search-params</h3><div class="usage"><code>(generate-search-params query aggs params)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-get-doc"><h3>get-doc</h3><div class="usage"><code>(get-doc {:keys [uri request-fn version], :as conn} index-name doc-type id opts)</code><code>(get-doc conn index-name id opts)</code></div><div class="doc"><pre class="plaintext">Inputs: ([{:keys [uri request-fn version], :as conn} :- ESConn index-name :- s/Str doc-type :- (s/maybe s/Str) id :- s/Str opts :- CRUDOptions] [conn :- ESConn index-name :- s/Str id :- s/Str opts :- CRUDOptions])

get a document on es and return only the source</pre></div></div><div class="public anchor" id="var-get-doc-uri"><h3>get-doc-uri</h3><div class="usage"></div><div class="doc"><pre class="plaintext">make an uri for doc retrieval
</pre></div></div><div class="public anchor" id="var-index-doc"><h3>index-doc</h3><div class="usage"><code>(index-doc conn index-name doc-type doc opts)</code><code>(index-doc conn index-name doc opts)</code></div><div class="doc"><pre class="plaintext">Inputs: ([conn :- ESConn index-name :- s/Str doc-type :- (s/maybe s/Str) doc :- s/Any opts :- CRUDOptions] [conn :- ESConn index-name :- s/Str doc :- s/Any opts :- CRUDOptions])

index a document on es return the indexed document</pre></div></div><div class="public anchor" id="var-index-doc-uri"><h3>index-doc-uri</h3><div class="usage"><code>(index-doc-uri uri index-name doc-type id)</code></div><div class="doc"><pre class="plaintext">make an uri for document index
</pre></div></div><div class="public anchor" id="var-params-.3Epagination"><h3>params-&gt;pagination</h3><div class="usage"><code>(params-&gt;pagination {:keys [sort_by sort_order offset limit search_after], :or {sort_order :asc, limit pagination/default-limit}})</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-partition-json-ops"><h3>partition-json-ops</h3><div class="usage"><code>(partition-json-ops json-ops max-size)</code></div><div class="doc"><pre class="plaintext">Return a lazy sequence of lists of ops whose size is less than max-size.
If a json-op exceeds the max size, it is included in a list of one element.</pre></div></div><div class="public anchor" id="var-query"><h3>query</h3><div class="usage"><code>(query {:keys [uri request-fn], :as conn} index-name q aggs {:keys [full-hits?], :as opts})</code><code>(query conn index-name q opts)</code></div><div class="doc"><pre class="plaintext">Inputs: ([{:keys [uri request-fn], :as conn} :- ESConn index-name :- (s/maybe s/Str) q :- (s/maybe ESQuery) aggs :- (s/maybe ESAggs) {:keys [full-hits?], :as opts} :- s/Any] [conn index-name q opts])

Search for documents on ES using any query. Performs aggregations when specified.</pre></div></div><div class="public anchor" id="var-search-docs"><h3>search-docs</h3><div class="usage"><code>(search-docs conn index-name es-query all-of opts)</code></div><div class="doc"><pre class="plaintext">Inputs: [conn :- ESConn index-name :- (s/maybe s/Str) es-query :- (s/maybe ESQuery) all-of :- (s/maybe #:s{Any s/Any}) opts :- s/Any]

Search for documents on ES using a query string search.  Also applies a filter map, converting
 the values in the all-of into must match terms.</pre></div></div><div class="public anchor" id="var-search-uri"><h3>search-uri</h3><div class="usage"><code>(search-uri uri index-name)</code></div><div class="doc"><pre class="plaintext">make an uri for search action
</pre></div></div><div class="public anchor" id="var-sort-params"><h3>sort-params</h3><div class="usage"><code>(sort-params sort_by sort_order)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-string-.3Einput-stream"><h3>string-&gt;input-stream</h3><div class="usage"><code>(string-&gt;input-stream s)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-update-by-query"><h3>update-by-query</h3><div class="usage"><code>(update-by-query {:keys [uri request-fn], :as conn} index-names form-params opts)</code></div><div class="doc"><pre class="plaintext">Inputs: [{:keys [uri request-fn], :as conn} :- ESConn index-names :- [s/Str] form-params :- (s/maybe UpdateByQueryParams) opts :- CRUDOptions]

Performs an update on every document in the data stream or index without modifying
the source, which is useful for picking up mapping changes.</pre></div></div><div class="public anchor" id="var-update-by-query-uri"><h3>update-by-query-uri</h3><div class="usage"><code>(update-by-query-uri uri index-names)</code></div><div class="doc"><pre class="plaintext">Inputs: [uri index-names]
</pre></div></div><div class="public anchor" id="var-update-doc"><h3>update-doc</h3><div class="usage"><code>(update-doc {:keys [uri request-fn version], :as conn} index-name doc-type id doc opts)</code><code>(update-doc conn index-name id doc opts)</code></div><div class="doc"><pre class="plaintext">Inputs: ([{:keys [uri request-fn version], :as conn} :- ESConn index-name :- s/Str doc-type :- (s/maybe s/Str) id :- s/Str doc :- s/Any opts :- CRUDOptions] [conn :- ESConn index-name :- s/Str id :- s/Str doc :- s/Any opts :- CRUDOptions])

update a document on es return the updated document</pre></div></div><div class="public anchor" id="var-update-doc-uri"><h3>update-doc-uri</h3><div class="usage"><code>(update-doc-uri uri index-name id)</code><code>(update-doc-uri uri index-name doc-type id)</code></div><div class="doc"><pre class="plaintext">make an uri for document update
</pre></div></div></div></body></html>